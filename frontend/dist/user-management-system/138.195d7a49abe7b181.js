"use strict";(self.webpackChunkuser_management_system=self.webpackChunkuser_management_system||[]).push([[138],{138:(J,v,u)=>{u.r(v),u.d(v,{RequestsModule:()=>Q});var d=u(177),o=u(8326),a=u(9979),l=u(4046),e=u(4438),m=u(3856);const h=(i,r,t,s)=>({"badge badge-secondary":i,"badge badge-success":r,"badge badge-danger":t,"badge badge-info":s});function b(i,r){if(1&i&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&i){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," (",t.quantity,") ")}}function F(i,r){if(1&i&&(e.j41(0,"div"),e.DNE(1,b,2,2,"div",7),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngForOf",t.items)}}function _(i,r){if(1&i&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.DNE(6,F,2,1,"div",8),e.k0s(),e.j41(7,"td")(8,"span",9),e.EFF(9),e.k0s()(),e.j41(10,"td")(11,"button",10),e.EFF(12,"View"),e.k0s()()()),2&i){const t=r.$implicit;e.R7$(2),e.Lme("",null==t.employee||null==t.employee.account?null:t.employee.account.firstName," ",null==t.employee||null==t.employee.account?null:t.employee.account.lastName,""),e.R7$(2),e.JRh(t.type),e.R7$(2),e.Y8G("ngIf",null==t.items?null:t.items.length),e.R7$(2),e.Y8G("ngClass",e.ziG(7,h,"pending"===t.status,"approved"===t.status,"rejected"===t.status,"fulfilled"===t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(2),e.FS9("routerLink",t.id)}}function k(i,r){1&i&&(e.j41(0,"tr")(1,"td",11),e.nrm(2,"span",12),e.k0s()())}let E=(()=>{class i{constructor(t,s,n){this.router=t,this.requestService=s,this.alertService=n}ngOnInit(){this.requestService.getAll().pipe((0,l.$)()).subscribe(t=>this.requests=t)}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(a.Ix),e.rXU(m.By),e.rXU(m.uE))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["ng-component"]],decls:22,vars:2,consts:[[1,"card"],[1,"card-header"],["routerLink","add",1,"btn","btn-primary","btn-sm","float-right"],[1,"card-body"],[1,"table","table-striped"],[2,"width","15%"],[2,"width","40%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngClass"],[1,"btn","btn-sm","btn-primary",3,"routerLink"],["colspan","5",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," Requests "),e.j41(3,"button",2),e.EFF(4,"Create Request"),e.k0s()(),e.j41(5,"div",3)(6,"table",4)(7,"thead")(8,"tr")(9,"th",5),e.EFF(10,"Employee"),e.k0s(),e.j41(11,"th",5),e.EFF(12,"Type"),e.k0s(),e.j41(13,"th",6),e.EFF(14,"Items"),e.k0s(),e.j41(15,"th",5),e.EFF(16,"Status"),e.k0s(),e.j41(17,"th",5),e.EFF(18,"Actions"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,_,13,12,"tr",7)(21,k,3,0,"tr",8),e.k0s()()()()),2&s&&(e.R7$(20),e.Y8G("ngForOf",n.requests),e.R7$(),e.Y8G("ngIf",!n.requests))},dependencies:[d.YU,d.Sq,d.bT,a.Wk],encapsulation:2})}}return i})();const y=(i,r,t,s)=>({"badge badge-secondary":i,"badge badge-success":r,"badge badge-danger":t,"badge badge-info":s});function j(i,r){if(1&i&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&i){const t=r.$implicit;e.R7$(),e.Lme(" ",t.name," (Quantity: ",t.quantity,") ")}}function q(i,r){if(1&i&&(e.j41(0,"div",8)(1,"h6"),e.EFF(2,"Items:"),e.k0s(),e.j41(3,"ul"),e.DNE(4,j,2,2,"li",9),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(4),e.Y8G("ngForOf",t.request.items)}}function R(i,r){if(1&i&&(e.j41(0,"div",5)(1,"h5"),e.EFF(2,"Request Information"),e.k0s(),e.j41(3,"p")(4,"strong"),e.EFF(5,"Employee:"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Type:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Status:"),e.k0s(),e.j41(14,"span",6),e.EFF(15),e.k0s()(),e.j41(16,"p")(17,"strong"),e.EFF(18,"Created:"),e.k0s(),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.DNE(21,q,5,1,"div",7),e.k0s()),2&i){const t=e.XpG();e.R7$(6),e.Lme(" ",null==t.request.employee||null==t.request.employee.account?null:t.request.employee.account.firstName," ",null==t.request.employee||null==t.request.employee.account?null:t.request.employee.account.lastName,""),e.R7$(4),e.SpI(" ",t.request.type,""),e.R7$(4),e.Y8G("ngClass",e.ziG(10,y,"pending"===t.request.status,"approved"===t.request.status,"rejected"===t.request.status,"fulfilled"===t.request.status)),e.R7$(),e.SpI(" ",t.request.status," "),e.R7$(4),e.SpI(" ",e.i5U(20,7,t.request.created,"medium"),""),e.R7$(2),e.Y8G("ngIf",null==t.request.items?null:t.request.items.length)}}function I(i,r){1&i&&e.nrm(0,"span",21)}function C(i,r){if(1&i){const t=e.RV6();e.j41(0,"form",10),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.j41(1,"div",11)(2,"label",12),e.EFF(3,"Update Status"),e.k0s(),e.j41(4,"select",13)(5,"option",14),e.EFF(6,"Pending"),e.k0s(),e.j41(7,"option",15),e.EFF(8,"Approved"),e.k0s(),e.j41(9,"option",16),e.EFF(10,"Rejected"),e.k0s(),e.j41(11,"option",17),e.EFF(12,"Fulfilled"),e.k0s()()(),e.j41(13,"div",11)(14,"button",18),e.DNE(15,I,1,0,"span",19),e.EFF(16," Update "),e.k0s(),e.j41(17,"a",20),e.EFF(18,"Back"),e.k0s()()()}if(2&i){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(14),e.Y8G("disabled",t.loading),e.R7$(),e.Y8G("ngIf",t.loading)}}let G=(()=>{class i{constructor(t,s,n,c,f){this.formBuilder=t,this.route=s,this.router=n,this.requestService=c,this.alertService=f,this.loading=!1,this.submitted=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.form=this.formBuilder.group({status:[""]}),this.requestService.getById(this.id).pipe((0,l.$)()).subscribe(t=>{this.request=t,this.form.patchValue({status:t.status})})}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.requestService.update(this.id,{status:this.form.value.status}).pipe((0,l.$)()).subscribe({next:()=>{this.alertService.success("Request updated",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(o.ok),e.rXU(a.nX),e.rXU(a.Ix),e.rXU(m.By),e.rXU(m.uE))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["ng-component"]],decls:6,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],["class","mb-4",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"mb-4"],[3,"ngClass"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[4,"ngFor","ngForOf"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","status"],["formControlName","status",1,"form-control"],["value","pending"],["value","approved"],["value","rejected"],["value","fulfilled"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],["routerLink","../",1,"btn","btn-link"],[1,"spinner-border","spinner-border-sm"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," Request Details "),e.k0s(),e.j41(3,"div",2),e.DNE(4,R,22,15,"div",3)(5,C,19,3,"form",4),e.k0s()()),2&s&&(e.R7$(4),e.Y8G("ngIf",n.request),e.R7$(),e.Y8G("ngIf",n.request))},dependencies:[d.YU,d.Sq,d.bT,o.qT,o.xH,o.y7,o.wz,o.BC,o.cb,o.j4,o.JD,a.Wk,d.vh],encapsulation:2})}}return i})();const p=i=>({"is-invalid":i});function $(i,r){if(1&i&&(e.j41(0,"option",24),e.EFF(1),e.k0s()),2&i){const t=r.$implicit;e.Y8G("value",t.id),e.R7$(),e.E5c(" ",null==t.account?null:t.account.firstName," ",null==t.account?null:t.account.lastName," (",t.employeeId,") ")}}function S(i,r){1&i&&(e.j41(0,"div"),e.EFF(1,"Employee is required"),e.k0s())}function T(i,r){if(1&i&&(e.j41(0,"div",25),e.DNE(1,S,2,0,"div",26),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.f.employeeId.errors.required)}}function N(i,r){1&i&&(e.j41(0,"div"),e.EFF(1,"Type is required"),e.k0s())}function Y(i,r){if(1&i&&(e.j41(0,"div",25),e.DNE(1,N,2,0,"div",26),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.f.type.errors.required)}}function A(i,r){1&i&&(e.j41(0,"div"),e.EFF(1,"Name is required"),e.k0s())}function X(i,r){if(1&i&&(e.j41(0,"div",38),e.DNE(1,A,2,0,"div",26),e.k0s()),2&i){const t=e.XpG().index,s=e.XpG();e.R7$(),e.Y8G("ngIf",s.items.at(t).get("name").errors.required)}}function D(i,r){1&i&&(e.j41(0,"div"),e.EFF(1,"Quantity is required"),e.k0s())}function x(i,r){1&i&&(e.j41(0,"div"),e.EFF(1,"Quantity must be at least 1"),e.k0s())}function U(i,r){if(1&i&&(e.j41(0,"div",38),e.DNE(1,D,2,0,"div",26)(2,x,2,0,"div",26),e.k0s()),2&i){const t=e.XpG().index,s=e.XpG();e.R7$(),e.Y8G("ngIf",s.items.at(t).get("quantity").errors.required),e.R7$(),e.Y8G("ngIf",s.items.at(t).get("quantity").errors.min)}}function B(i,r){if(1&i){const t=e.RV6();e.j41(0,"button",39),e.bIt("click",function(){e.eBV(t);const n=e.XpG().index,c=e.XpG();return e.Njj(c.removeItem(n))}),e.nrm(1,"i",40),e.k0s()}}function V(i,r){if(1&i&&(e.j41(0,"div",27)(1,"div",28)(2,"div",29)(3,"div",4)(4,"label"),e.EFF(5,"Name"),e.k0s(),e.nrm(6,"input",30),e.DNE(7,X,2,1,"div",31),e.k0s()(),e.j41(8,"div",32)(9,"div",4)(10,"label"),e.EFF(11,"Quantity"),e.k0s(),e.nrm(12,"input",33),e.DNE(13,U,3,2,"div",31),e.k0s()(),e.j41(14,"div",34)(15,"div",4)(16,"label"),e.EFF(17,"Description"),e.k0s(),e.nrm(18,"input",35),e.k0s()(),e.j41(19,"div",36),e.DNE(20,B,2,0,"button",37),e.k0s()()()),2&i){const t=r.index,s=e.XpG();e.Y8G("formGroupName",t),e.R7$(6),e.Y8G("ngClass",e.eq3(6,p,s.submitted&&s.items.at(t).get("name").errors)),e.R7$(),e.Y8G("ngIf",s.submitted&&s.items.at(t).get("name").errors),e.R7$(5),e.Y8G("ngClass",e.eq3(8,p,s.submitted&&s.items.at(t).get("quantity").errors)),e.R7$(),e.Y8G("ngIf",s.submitted&&s.items.at(t).get("quantity").errors),e.R7$(7),e.Y8G("ngIf",s.items.length>1)}}function w(i,r){1&i&&(e.j41(0,"div",4)(1,"label",41),e.EFF(2,"Status"),e.k0s(),e.j41(3,"select",42)(4,"option",43),e.EFF(5,"Pending"),e.k0s(),e.j41(6,"option",44),e.EFF(7,"Approved"),e.k0s(),e.j41(8,"option",45),e.EFF(9,"Rejected"),e.k0s(),e.j41(10,"option",46),e.EFF(11,"Fulfilled"),e.k0s()()())}function L(i,r){1&i&&e.nrm(0,"span",47)}let g=(()=>{class i{constructor(t,s,n,c,f,z){this.formBuilder=t,this.route=s,this.router=n,this.requestService=c,this.employeeService=f,this.alertService=z,this.loading=!1,this.submitted=!1,this.employees=[]}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.employeeService.getAll().pipe((0,l.$)()).subscribe(t=>{this.employees=t}),this.form=this.formBuilder.group({employeeId:["",o.k0.required],type:["",o.k0.required],status:["pending",o.k0.required],items:this.formBuilder.array([this.createItem()])}),this.isAddMode||this.requestService.getById(this.id).pipe((0,l.$)()).subscribe(t=>{for(;this.items.length;)this.items.removeAt(0);t.items.forEach(s=>{this.items.push(this.formBuilder.group(s))}),this.form.patchValue(t)})}get f(){return this.form.controls}get items(){return this.form.get("items")}createItem(){return this.formBuilder.group({name:["",o.k0.required],quantity:[1,[o.k0.required,o.k0.min(1)]],description:[""]})}addItem(){this.items.push(this.createItem())}removeItem(t){this.items.removeAt(t)}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createRequest():this.updateRequest())}createRequest(){this.requestService.create(this.form.value).pipe((0,l.$)()).subscribe({next:()=>{this.alertService.success("Request created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}updateRequest(){this.requestService.update(this.id,this.form.value).pipe((0,l.$)()).subscribe({next:()=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(o.ok),e.rXU(a.nX),e.rXU(a.Ix),e.rXU(m.By),e.rXU(m.O0),e.rXU(m.uE))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["ng-component"]],decls:40,vars:15,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","employeeId"],["id","employeeId","formControlName","employeeId",1,"form-control",3,"ngClass"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback d-block",4,"ngIf"],["for","type"],["id","type","formControlName","type",1,"form-control",3,"ngClass"],["value",""],["value","supply"],["value","equipment"],["value","other"],["formArrayName","items",1,"mb-4"],["class","item-group border p-3 mb-3",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fa","fa-plus"],["class","form-group",4,"ngIf"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],["routerLink","../../",1,"btn","btn-link"],[3,"value"],[1,"invalid-feedback","d-block"],[4,"ngIf"],[1,"item-group","border","p-3","mb-3",3,"formGroupName"],[1,"row"],[1,"col-md-4"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],[1,"col-md-2"],["type","number","formControlName","quantity",1,"form-control",3,"ngClass"],[1,"col-md-5"],["type","text","formControlName","description",1,"form-control"],[1,"col-md-1","d-flex","align-items-end"],["type","button","class","btn btn-danger",3,"click",4,"ngIf"],[1,"invalid-feedback"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],["for","status"],["id","status","formControlName","status",1,"form-control"],["value","pending"],["value","approved"],["value","rejected"],["value","fulfilled"],[1,"spinner-border","spinner-border-sm"]],template:function(s,n){1&s&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2),e.k0s(),e.j41(3,"div",2)(4,"form",3),e.bIt("ngSubmit",function(){return n.onSubmit()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Select Employee"),e.k0s(),e.j41(8,"select",6)(9,"option",7),e.EFF(10,"Select an employee"),e.k0s(),e.DNE(11,$,2,4,"option",8),e.k0s(),e.DNE(12,T,2,1,"div",9),e.k0s(),e.j41(13,"div",4)(14,"label",10),e.EFF(15,"Request Type"),e.k0s(),e.j41(16,"select",11)(17,"option",12),e.EFF(18,"-- Select Type --"),e.k0s(),e.j41(19,"option",13),e.EFF(20,"Supply Request"),e.k0s(),e.j41(21,"option",14),e.EFF(22,"Equipment Request"),e.k0s(),e.j41(23,"option",15),e.EFF(24,"Other"),e.k0s()(),e.DNE(25,Y,2,1,"div",9),e.k0s(),e.j41(26,"div",16)(27,"h5"),e.EFF(28,"Items"),e.k0s(),e.DNE(29,V,21,10,"div",17),e.j41(30,"button",18),e.bIt("click",function(){return n.addItem()}),e.nrm(31,"i",19),e.EFF(32," Add Item "),e.k0s()(),e.DNE(33,w,12,0,"div",20),e.j41(34,"div",4)(35,"button",21),e.DNE(36,L,1,0,"span",22),e.EFF(37," Save "),e.k0s(),e.j41(38,"a",23),e.EFF(39,"Cancel"),e.k0s()()()()()),2&s&&(e.R7$(2),e.SpI(" ",n.isAddMode?"Add":"Edit"," Request "),e.R7$(2),e.Y8G("formGroup",n.form),e.R7$(4),e.Y8G("ngClass",e.eq3(11,p,n.submitted&&n.f.employeeId.errors)),e.R7$(3),e.Y8G("ngForOf",n.employees),e.R7$(),e.Y8G("ngIf",n.submitted&&n.f.employeeId.errors),e.R7$(4),e.Y8G("ngClass",e.eq3(13,p,n.submitted&&n.f.type.errors)),e.R7$(9),e.Y8G("ngIf",n.submitted&&n.f.type.errors),e.R7$(4),e.Y8G("ngForOf",n.items.controls),e.R7$(4),e.Y8G("ngIf",!n.isAddMode),e.R7$(2),e.Y8G("disabled",n.loading),e.R7$(),e.Y8G("ngIf",n.loading))},dependencies:[d.YU,d.Sq,d.bT,o.qT,o.xH,o.y7,o.me,o.Q0,o.wz,o.BC,o.cb,o.j4,o.JD,o.$R,o.v8,a.Wk],encapsulation:2})}}return i})();const O=[{path:"",component:E},{path:"add",component:g},{path:":id/edit",component:g},{path:":id",component:G}];let M=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[a.iI.forChild(O),a.iI]})}}return i})(),Q=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[d.MD,o.X1,a.iI,M]})}}return i})()}}]);
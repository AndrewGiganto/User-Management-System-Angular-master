"use strict";(self.webpackChunkuser_management_system=self.webpackChunkuser_management_system||[]).push([[928],{5928:(O,f,c)=>{c.r(f),c.d(f,{WorkflowsModule:()=>Y});var a=c(177),r=c(8326),l=c(9979),p=c(4046),e=c(4438),d=c(3856);const h=(o,n,t)=>({"badge-success":o,"badge-warning":n,"badge-danger":t}),g=o=>["/admin/workflows",o],k=o=>({employeeId:o});function w(o,n){1&o&&(e.j41(0,"div",13)(1,"div",14)(2,"span",15),e.EFF(3,"Loading..."),e.k0s()()())}function v(o,n){if(1&o){const t=e.RV6();e.j41(0,"a",16),e.bIt("click",function(){const s=e.eBV(t).$implicit,m=e.XpG();return e.Njj(m.onEmployeeSelect(s.id))}),e.j41(1,"div",17)(2,"h5",18),e.EFF(3),e.k0s(),e.j41(4,"small"),e.EFF(5),e.k0s()(),e.j41(6,"p",18),e.EFF(7),e.k0s(),e.j41(8,"small"),e.EFF(9),e.k0s()()}if(2&o){const t=n.$implicit,i=e.XpG();e.AVh("active",i.selectedEmployeeId===t.id),e.R7$(3),e.Lme("",t.account.firstName," ",t.account.lastName,""),e.R7$(2),e.JRh(t.position),e.R7$(2),e.SpI("ID: ",t.employeeId,""),e.R7$(2),e.SpI("Department: ",t.department.name,"")}}function F(o,n){1&o&&(e.j41(0,"div",19),e.EFF(1," Please select an employee to view their workflows "),e.k0s())}function b(o,n){1&o&&(e.j41(0,"div",13)(1,"div",14)(2,"span",15),e.EFF(3,"Loading..."),e.k0s()()())}function y(o,n){1&o&&(e.j41(0,"div",19),e.EFF(1," No workflows found for this employee "),e.k0s())}function E(o,n){if(1&o&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"span",22),e.EFF(5),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.nI1(8,"date"),e.k0s(),e.j41(9,"td")(10,"a",23),e.EFF(11," View "),e.k0s()()()),2&o){const t=n.$implicit,i=e.XpG(2);e.R7$(2),e.JRh(t.type),e.R7$(2),e.Y8G("ngClass",e.sMw(9,h,"completed"===t.status,"in-progress"===t.status,"failed"===t.status)),e.R7$(),e.SpI(" ",t.status," "),e.R7$(2),e.JRh(e.i5U(8,6,t.created,"medium")),e.R7$(3),e.Y8G("routerLink",e.eq3(13,g,t.id))("queryParams",e.eq3(15,k,i.selectedEmployeeId))}}function I(o,n){if(1&o&&(e.j41(0,"div")(1,"table",20)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Type"),e.k0s(),e.j41(6,"th"),e.EFF(7,"Status"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Created"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Actions"),e.k0s()()(),e.j41(12,"tbody"),e.DNE(13,E,12,17,"tr",21),e.k0s()()()),2&o){const t=e.XpG();e.R7$(13),e.Y8G("ngForOf",t.workflows)}}function _(o,n){if(1&o&&(e.j41(0,"option",14),e.EFF(1),e.k0s()),2&o){const t=n.$implicit;e.Y8G("value",t.id),e.R7$(),e.E5c(" ",null==t.account?null:t.account.firstName," ",null==t.account?null:t.account.lastName," (",t.employeeId,") ")}}function S(o,n){1&o&&e.nrm(0,"span",15)}const C=(o,n,t,i)=>({"badge badge-secondary":o,"badge badge-warning":n,"badge badge-success":t,"badge badge-danger":i});function R(o,n){if(1&o&&(e.j41(0,"div",8)(1,"h6"),e.EFF(2,"Details:"),e.k0s(),e.j41(3,"pre"),e.EFF(4),e.nI1(5,"json"),e.k0s()()),2&o){const t=e.XpG(2);e.R7$(4),e.JRh(e.bMT(5,1,t.workflow.details))}}function G(o,n){if(1&o&&(e.j41(0,"div",5)(1,"h5"),e.EFF(2,"Workflow Information"),e.k0s(),e.j41(3,"p")(4,"strong"),e.EFF(5,"Employee:"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"p")(8,"strong"),e.EFF(9,"Type:"),e.k0s(),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13,"Status:"),e.k0s(),e.j41(14,"span",6),e.EFF(15),e.k0s()(),e.j41(16,"p")(17,"strong"),e.EFF(18,"Created:"),e.k0s(),e.EFF(19),e.nI1(20,"date"),e.k0s(),e.DNE(21,R,6,3,"div",7),e.k0s()),2&o){const t=e.XpG();e.R7$(6),e.Lme(" ",null==t.workflow.employee||null==t.workflow.employee.account?null:t.workflow.employee.account.firstName," ",null==t.workflow.employee||null==t.workflow.employee.account?null:t.workflow.employee.account.lastName,""),e.R7$(4),e.SpI(" ",t.workflow.type,""),e.R7$(4),e.Y8G("ngClass",e.ziG(10,C,"pending"===t.workflow.status,"in-progress"===t.workflow.status,"completed"===t.workflow.status,"rejected"===t.workflow.status)),e.R7$(),e.SpI(" ",t.workflow.status," "),e.R7$(4),e.SpI(" ",e.i5U(20,7,t.workflow.created,"medium"),""),e.R7$(2),e.Y8G("ngIf",t.workflow.details)}}function T(o,n){1&o&&e.nrm(0,"span",20)}function X(o,n){if(1&o){const t=e.RV6();e.j41(0,"form",9),e.bIt("ngSubmit",function(){e.eBV(t);const s=e.XpG();return e.Njj(s.onSubmit())}),e.j41(1,"div",10)(2,"label",11),e.EFF(3,"Update Status"),e.k0s(),e.j41(4,"select",12)(5,"option",13),e.EFF(6,"Pending"),e.k0s(),e.j41(7,"option",14),e.EFF(8,"In Progress"),e.k0s(),e.j41(9,"option",15),e.EFF(10,"Completed"),e.k0s(),e.j41(11,"option",16),e.EFF(12,"Rejected"),e.k0s()()(),e.j41(13,"div",10)(14,"button",17),e.DNE(15,T,1,0,"span",18),e.EFF(16," Update "),e.k0s(),e.j41(17,"a",19),e.EFF(18,"Back"),e.k0s()()()}if(2&o){const t=e.XpG();e.Y8G("formGroup",t.form),e.R7$(14),e.Y8G("disabled",t.loading),e.R7$(),e.Y8G("ngIf",t.loading)}}const U=[{path:"",component:(()=>{class o{constructor(t,i,s,m,u){this.router=t,this.route=i,this.employeeService=s,this.workflowService=m,this.alertService=u,this.employees=[],this.selectedEmployeeId=null,this.workflows=[],this.loading=!1}ngOnInit(){this.loadEmployees(),this.route.queryParams.subscribe(t=>{t.employeeId&&this.onEmployeeSelect(Number(t.employeeId))})}loadEmployees(){this.loading=!0,this.employeeService.getAll().pipe((0,p.$)()).subscribe({next:t=>{this.employees=t,this.loading=!1},error:t=>{this.alertService.error(t),this.loading=!1}})}onEmployeeSelect(t){this.selectedEmployeeId=t,this.loadWorkflows(t),this.router.navigate([],{relativeTo:this.route,queryParams:{employeeId:t},queryParamsHandling:"merge"})}loadWorkflows(t){this.loading=!0,this.workflowService.getByEmployee(t).pipe((0,p.$)()).subscribe({next:i=>{this.workflows=i,this.loading=!1},error:i=>{this.alertService.error(i),this.loading=!1}})}static{this.\u0275fac=function(i){return new(i||o)(e.rXU(l.Ix),e.rXU(l.nX),e.rXU(d.O0),e.rXU(d.D_),e.rXU(d.uE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["ng-component"]],decls:20,vars:6,consts:[[1,"row"],[1,"col-md-4"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body","p-0"],["class","text-center p-3",4,"ngIf"],[1,"list-group","list-group-flush"],["href","javascript:void(0)","class","list-group-item list-group-item-action",3,"active","click",4,"ngFor","ngForOf"],[1,"col-md-8"],[1,"card-body"],["class","alert alert-info",4,"ngIf"],[4,"ngIf"],[1,"text-center","p-3"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],["href","javascript:void(0)",1,"list-group-item","list-group-item-action",3,"click"],[1,"d-flex","w-100","justify-content-between"],[1,"mb-1"],[1,"alert","alert-info"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"badge",3,"ngClass"],[1,"btn","btn-sm","btn-primary",3,"routerLink","queryParams"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3",4),e.EFF(5,"Employees"),e.k0s()(),e.j41(6,"div",5),e.DNE(7,w,4,0,"div",6),e.j41(8,"div",7),e.DNE(9,v,10,7,"a",8),e.k0s()()()(),e.j41(10,"div",9)(11,"div",2)(12,"div",3)(13,"h3",4),e.EFF(14,"Workflows"),e.k0s()(),e.j41(15,"div",10),e.DNE(16,F,2,0,"div",11)(17,b,4,0,"div",6)(18,y,2,0,"div",11)(19,I,14,1,"div",12),e.k0s()()()()),2&i&&(e.R7$(7),e.Y8G("ngIf",s.loading),e.R7$(2),e.Y8G("ngForOf",s.employees),e.R7$(7),e.Y8G("ngIf",!s.selectedEmployeeId),e.R7$(),e.Y8G("ngIf",s.loading),e.R7$(),e.Y8G("ngIf",s.selectedEmployeeId&&(!s.workflows||0===s.workflows.length)&&!s.loading),e.R7$(),e.Y8G("ngIf",s.workflows&&s.workflows.length>0))},dependencies:[a.YU,a.Sq,a.bT,l.Wk,a.vh],encapsulation:2})}}return o})()},{path:"onboarding",component:(()=>{class o{constructor(t,i,s,m,u,D){this.formBuilder=t,this.router=i,this.route=s,this.employeeService=m,this.workflowService=u,this.alertService=D,this.loading=!1,this.submitted=!1}ngOnInit(){this.form=this.formBuilder.group({employeeId:["",[]],details:[""]}),this.employeeService.getAll().pipe((0,p.$)()).subscribe(t=>this.employees=t)}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.workflowService.initiateOnboarding(this.form.value).pipe((0,p.$)()).subscribe({next:()=>{this.alertService.success("Onboarding workflow initiated",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:t=>{this.alertService.error(t),this.loading=!1}}))}static{this.\u0275fac=function(i){return new(i||o)(e.rXU(r.ok),e.rXU(l.Ix),e.rXU(l.nX),e.rXU(d.O0),e.rXU(d.D_),e.rXU(d.uE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["ng-component"]],decls:22,vars:4,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","employeeId"],["formControlName","employeeId",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","details"],["formControlName","details","rows","5",1,"form-control"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],["routerLink","../",1,"btn","btn-link"],[3,"value"],[1,"spinner-border","spinner-border-sm"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," Initiate Onboarding Workflow "),e.k0s(),e.j41(3,"div",2)(4,"form",3),e.bIt("ngSubmit",function(){return s.onSubmit()}),e.j41(5,"div",4)(6,"label",5),e.EFF(7,"Employee"),e.k0s(),e.j41(8,"select",6)(9,"option",7),e.EFF(10,"-- Select Employee --"),e.k0s(),e.DNE(11,_,2,4,"option",8),e.k0s()(),e.j41(12,"div",4)(13,"label",9),e.EFF(14,"Details (JSON)"),e.k0s(),e.nrm(15,"textarea",10),e.k0s(),e.j41(16,"div",4)(17,"button",11),e.DNE(18,S,1,0,"span",12),e.EFF(19," Initiate "),e.k0s(),e.j41(20,"a",13),e.EFF(21,"Cancel"),e.k0s()()()()()),2&i&&(e.R7$(4),e.Y8G("formGroup",s.form),e.R7$(7),e.Y8G("ngForOf",s.employees),e.R7$(6),e.Y8G("disabled",s.loading),e.R7$(),e.Y8G("ngIf",s.loading))},dependencies:[a.Sq,a.bT,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.j4,r.JD,l.Wk],encapsulation:2})}}return o})()},{path:":id",component:(()=>{class o{constructor(t,i,s,m,u){this.formBuilder=t,this.route=i,this.router=s,this.workflowService=m,this.alertService=u,this.loading=!1,this.submitted=!1,this.employeeId=null}ngOnInit(){this.id=this.route.snapshot.params.id,this.route.queryParams.subscribe(t=>{this.employeeId=t.employeeId?Number(t.employeeId):null}),this.form=this.formBuilder.group({status:[""]}),this.employeeId&&(this.loading=!0,this.workflowService.getByEmployee(this.employeeId).pipe((0,p.$)()).subscribe({next:t=>{console.log("Route ID:",this.id),console.log("All workflows:",t),this.workflow=t.find(i=>i.id==this.id),console.log("Found workflow:",this.workflow),this.workflow?(console.log("Workflow exists, patching form"),this.form.patchValue({status:this.workflow.status})):this.alertService.error("Workflow not found in list"),this.loading=!1},error:t=>{this.alertService.error(t),this.loading=!1}}))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.workflowService.updateStatus(this.id,this.form.value.status).pipe((0,p.$)()).subscribe({next:()=>{this.alertService.success("Workflow updated",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route,queryParams:this.employeeId?{employeeId:this.employeeId}:{}})},error:t=>{this.alertService.error(t),this.loading=!1}}))}static{this.\u0275fac=function(i){return new(i||o)(e.rXU(r.ok),e.rXU(l.nX),e.rXU(l.Ix),e.rXU(d.D_),e.rXU(d.uE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["ng-component"]],decls:6,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],["class","mb-4",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"mb-4"],[3,"ngClass"],["class","mt-3",4,"ngIf"],[1,"mt-3"],[3,"ngSubmit","formGroup"],[1,"form-group"],["for","status"],["formControlName","status",1,"form-control"],["value","pending"],["value","in-progress"],["value","completed"],["value","rejected"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],["routerLink","../",1,"btn","btn-link"],[1,"spinner-border","spinner-border-sm"]],template:function(i,s){1&i&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2," Workflow Details "),e.k0s(),e.j41(3,"div",2),e.DNE(4,G,22,15,"div",3)(5,X,19,3,"form",4),e.k0s()()),2&i&&(e.R7$(4),e.Y8G("ngIf",s.workflow),e.R7$(),e.Y8G("ngIf",s.workflow))},dependencies:[a.YU,a.bT,r.qT,r.xH,r.y7,r.wz,r.BC,r.cb,r.j4,r.JD,l.Wk,a.TG,a.vh],encapsulation:2})}}return o})()}];let N=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[l.iI.forChild(U),l.iI]})}}return o})(),Y=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[a.MD,r.X1,l.iI,N]})}}return o})()}}]);